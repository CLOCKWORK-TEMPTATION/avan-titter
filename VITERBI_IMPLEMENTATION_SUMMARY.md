# ููุฎุต ุชูููุฐ ูุธุงู Viterbi/HMM

## ๐ ุญุงูุฉ ุงููุดุฑูุน: โ ุงููุฑุงุญู ุงูุฃุณุงุณูุฉ ููุชููุฉ

ุชุงุฑูุฎ ุงูุชูููุฐ: 2026-01-14

---

## โ ูุง ุชู ุฅูุฌุงุฒู

### 1. ุงูุจููุฉ ุงูุฃุณุงุณูุฉ (ููุชููุฉ 100%)

#### ุงูุฎุทูุฉ 1: ุชุนุฑููุงุช ุงูุฃููุงุน ูู `types.ts`
- โ ุฅุถุงูุฉ ููุน `ViterbiState` ูุน ุฌููุน ุงูุญุงูุงุช ุงูููููุฉ (11 ุญุงูุฉ)
- โ ุฅุถุงูุฉ ูุตูููุฉ `ALL_STATES` ููุงุณุชุฎุฏุงู ูู ุงูุญุณุงุจุงุช
- โ ุฅุถุงูุฉ ูุงุฌูุฉ `ViterbiCell` ูุชูุซูู ุฎูุงูุง ุฌุฏูู Viterbi
- โ ุฅุถุงูุฉ ูุงุฌูุฉ `ClassificationOptions` ูุฎูุงุฑุงุช ุงูุชุตููู
- โ ุชุญุฏูุซ `BatchClassificationResult` ูุฏุนู `viterbiOverride`

#### ุงูุฎุทูุฉ 2: ูุตูููุฉ ุงูุงูุชูุงู `TransitionMatrix.ts`
- โ ุฅูุดุงุก ููู `src/classes/TransitionMatrix.ts`
- โ ุชุนุฑูู ูุตูููุฉ ุงูุชูุงูุงุช ูุงููุฉ (11x11 ุญุงูุฉ)
- โ ุฏุงูุฉ `getTransitionScore` ููุญุตูู ุนูู ุฏุฑุฌุฉ ุงูุงูุชูุงู
- โ ุฏุงูุฉ `getMostLikelyNextStates` ููุชุดุฎูุต
- โ ุฏุฑุฌุงุช ูุถุจูุทุฉ ุจุนูุงูุฉ (0-100) ููู ุงูุชูุงู

#### ุงูุฎุทูุฉ 3: ุญุงุณุจ ุงูุงูุจุนุงุซ `EmissionCalculator.ts`
- โ ุฅูุดุงุก ููู `src/classes/EmissionCalculator.ts`
- โ ุฏุงูุฉ `calculateEmissions` ุงูุฑุฆูุณูุฉ
- โ ุฏูุงู ุญุณุงุจ ููู ููุน:
  - `calculateCharacterEmission`
  - `calculateDialogueEmission`
  - `calculateActionEmission`
  - `calculateParentheticalEmission`
  - `calculateSceneHeader2Emission`
  - `calculateSceneHeader3Emission`
- โ ุฏุนู `DocumentMemory` ูุชุญุณูู ุงูุฏูุฉ
- โ ูุญุต ุณุฑูุน ููุญุงูุงุช ุงููุงุถุญุฉ (ุจุณููุฉุ ุงูุชูุงูุ ุฅูุฎ)

#### ุงูุฎุทูุฉ 4: ูุญุฑู Viterbi `ViterbiDecoder.ts`
- โ ุฅูุดุงุก ููู `src/classes/ViterbiDecoder.ts`
- โ ุชูููุฐ ุฎูุงุฑุฒููุฉ Viterbi ุงููุงููุฉ:
  - ุญุณุงุจ ุฌููุน ุฏุฑุฌุงุช ุงูุงูุจุนุงุซ
  - ุชููุฆุฉ ุฌุฏูู Viterbi
  - ููุก ุงูุฌุฏูู ุฏููุงููููุงู
  - ุงูุชุชุจุน ุงูุฎููู (Backtracking)
  - ุจูุงุก ุงููุชุงุฆุฌ ุงูุชูุตูููุฉ
- โ ุฏุงูุฉ `explainOverride` ูุดุฑุญ ุงูุชุบููุฑุงุช
- โ ูุงุฌูุฉ `ViterbiResult` ูููุชุงุฆุฌ
- โ ุฏุนู ุฃูุฒุงู ูุงุจูุฉ ููุชุฎุตูุต (emission/transition)

---

## ๐ ุงููููุงุช ุงูููุดุฃุฉ

1. **`src/classes/TransitionMatrix.ts`** (206 ุณุทุฑ)
   - ูุตูููุฉ ุงูุชูุงูุงุช ุดุงููุฉ ุจูู ุฌููุน ุงูุญุงูุงุช
   - ุฏูุงู ูุณุงุนุฏุฉ ูููุตูู ูุงูุชุดุฎูุต

2. **`src/classes/EmissionCalculator.ts`** (371 ุณุทุฑ)
   - ุญุณุงุจ ุงุญุชูุงูุงุช ุงูุงูุจุนุงุซ ููู ููุน
   - 6 ุฏูุงู ูุชุฎุตุตุฉ ูุฃููุงุน ูุฎุชููุฉ
   - ุชูุงูู ูุน DocumentMemory

3. **`src/classes/ViterbiDecoder.ts`** (191 ุณุทุฑ)
   - ุชูููุฐ ุฎูุงุฑุฒููุฉ Viterbi ุงููุงููุฉ
   - ุดุฑุญ ุชููุงุฆู ููุชุบููุฑุงุช
   - ูุชุงุฆุฌ ุชูุตูููุฉ ููู ุณุทุฑ

4. **`VITERBI_IMPLEMENTATION_CHECKLIST.md`**
   - ูุงุฆูุฉ ุชุญูู ุดุงููุฉ ูุฌููุน ุงูุฎุทูุงุช
   - ุชุชุจุน ุงูุชูุฏู ูุงูุฅูุฌุงุฒุงุช

---

## ๐ง ุงูุชุนุฏููุงุช ุนูู ุงููููุงุช ุงูููุฌูุฏุฉ

### `src/types/types.ts`
- ุฅุถุงูุฉ ุชุนุฑููุงุช Viterbi (ViterbiState, ALL_STATES, ViterbiCell)
- ุฅุถุงูุฉ ClassificationOptions
- ุชุญุฏูุซ BatchClassificationResult ุจุญูู viterbiOverride

---

## โ๏ธ ููููุฉ ุนูู ุงููุธุงู

### 1. ูุตูููุฉ ุงูุงูุชูุงู (Transition Matrix)
ุชุญุฏุฏ ุงุญุชูุงููุฉ ุงูุงูุชูุงู ูู ููุน ุณุทุฑ ุฅูู ุขุฎุฑ:
- `character โ dialogue`: 95 (ุนุงููุฉ ุฌุฏุงู)
- `character โ character`: 8 (ููุฎูุถุฉ)
- `action โ action`: 85 (ุงุณุชูุฑุงุฑ ุงููุตู)

### 2. ุญุณุงุจ ุงูุงูุจุนุงุซ (Emission Calculation)
ูุญุณุจ ุงุญุชูุงููุฉ ุฃู ูููู ุงูุณุทุฑ ูู ููุน ูุนูู ุจูุงุกู ุนูู:
- ูุญุชูู ุงูุณุทุฑ (ูููุงุชุ ุนูุงูุงุช ุชุฑููู)
- ุทูู ุงูุณุทุฑ ูุนุฏุฏ ุงููููุงุช
- ุงูุดุฎุตูุงุช ุงููุนุฑููุฉ (DocumentMemory)
- ุฃููุงุท ูุบููุฉ (ุฃูุนุงูุ ุถูุงุฆุฑุ ุฅูุฎ)

### 3. ุฎูุงุฑุฒููุฉ Viterbi
ุชุฌุฏ ุฃูุถู ุชุณูุณู ููุฃููุงุน ุนุจุฑ ุงููุต ุจุงููุงูู:
```
Best sequence = argmax(ฮฃ[Emission ร weight + Transition ร weight])
```

---

## ๐ ุงูุฎุทูุงุช ุงููุชุจููุฉ

### ุงูุฎุทูุฉ 5: ุฏูุฌ Viterbi ูู ScreenplayClassifier โณ
- ุฅุถุงูุฉ ุฏุงูุฉ `classifyWithViterbi`
- ุฅุถุงูุฉ ุฏุงูุฉ `compareGreedyVsViterbi` (ููุชุดุฎูุต)
- ุชุญุฏูุซ ุฏุงูุฉ `classify` ุงูุฑุฆูุณูุฉ

### ุงูุฎุทูุฉ 6: ุฃุฏูุงุช ุงูุชุดุฎูุต (ุงุฎุชูุงุฑู) โณ
- ุฅูุดุงุก `ViterbiDiagnostics.ts`
- ุฏูุงู ูุชุญููู ุงููุชุงุฆุฌ
- ุงูุชุฑุงุญ ุชุญุณููุงุช ูููุตูููุงุช

### ุงูุฎุทูุฉ 8: ุชูุญูุฏ ูุงุฌูุฉ ุงูุชุตููู โณ
- ุฏูุฌ Viterbi ูุน ุงููุธุงู ุงูุญุงูู
- ุฏุนู ุงูุชุจุฏูู ุจูู Greedy ู Viterbi
- ุงูุญูุงุธ ุนูู ุงูุชูุงูู ูุน ุงูููุฏ ุงูููุฌูุฏ

### ุงูุงุฎุชุจุงุฑุงุช ุงูููุงุฆูุฉ โณ
- ุงุฎุชุจุงุฑ ุนูู ูุตูุต ูุชููุนุฉ
- ููุงุฑูุฉ ุงููุชุงุฆุฌ (Greedy vs Viterbi)
- ุถุจุท ุงูุฃูุฒุงู ูุงููุตูููุงุช

---

## ๐ฏ ุงูููุงุฆุฏ ุงููุชููุนุฉ

1. **ุชุญุณูู ุงูุฏูุฉ**: ุงููุธุฑ ููุณูุงู ุงููุงูู ุจุฏูุงู ูู ุงููุฑุงุฑุงุช ุงููุญููุฉ
2. **ุชูููู ุงูุฃุฎุทุงุก ุงููุชุณูุณูุฉ**: ุฎุทุฃ ูุงุญุฏ ูู ูุคุซุฑ ุนูู ุงูุณุทูุฑ ุงูุชุงููุฉ
3. **ุดูุงููุฉ ุฃูุจุฑ**: ุดุฑุญ ุชููุงุฆู ููู ุชุบููุฑ ูู ุงูุชุตููู
4. **ูุฑููุฉ**: ุฃูุฒุงู ูุงุจูุฉ ููุชุฎุตูุต ุญุณุจ ููุน ุงููุต

---

## ๐ ููุงุญุธุงุช ุชูููุฉ

### ุงูุฃูุฒุงู ุงูุงูุชุฑุงุถูุฉ
- **Emission Weight**: 0.6 (60%)
- **Transition Weight**: 0.4 (40%)

ูููู ุชุนุฏูููุง ุญุณุจ ุงูุญุงุฌุฉ:
- ูุตูุต ูุงุถุญุฉ โ ุฒูุงุฏุฉ emission weight
- ูุตูุต ุนุดูุงุฆูุฉ โ ุฒูุงุฏุฉ transition weight

### ุงูุชุนููุฏ ุงูุญุณุงุจู
- **ุงูุฒูู**: O(n ร sยฒ) ุญูุซ n = ุนุฏุฏ ุงูุณุทูุฑุ s = ุนุฏุฏ ุงูุญุงูุงุช
- **ุงููุณุงุญุฉ**: O(n ร s)
- ููุงุณุจ ูููุตูุต ุญุชู ุขูุงู ุงูุณุทูุฑ

---

## โ ุงูุชุญูู ูู ุงูุจูุงุก

ุฌููุน ุงููููุงุช ุงูููุดุฃุฉ ุชู ุงูุชุญูู ูููุง ุจูุฌุงุญ:
```bash
npm run type-check
# Exit code: 0 โ
```

ูุง ุชูุฌุฏ ุฃุฎุทุงุก TypeScript ูู ุงูููุฏ ุงููููุฐ.

---

## ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ ุงูููุตู ุจูุง

1. **ุฏูุฌ Viterbi ูู ScreenplayClassifier** (ุงูุฎุทูุฉ 5)
   - ุฃููููุฉ ุนุงููุฉ ูุฅููุงู ุงูุชูุงูู

2. **ุงุฎุชุจุงุฑ ุนูู ูุตูุต ุญููููุฉ**
   - ููุงุฑูุฉ ุงููุชุงุฆุฌ ูุน ุงูุชุตููู ุงูุญุงูู
   - ููุงุณ ุงูุชุญุณู ูู ุงูุฏูุฉ

3. **ุถุจุท ุงููุตูููุงุช** (ุฅู ูุฒู)
   - ุจูุงุกู ุนูู ูุชุงุฆุฌ ุงูุงุฎุชุจุงุฑุงุช
   - ุงุณุชุฎุฏุงู ุฃุฏูุงุช ุงูุชุดุฎูุต

4. **ุชูุซูู ุงูุงุณุชุฎุฏุงู**
   - ุฃูุซูุฉ ุนูููุฉ
   - ุฏููู ุงููุณุชุฎุฏู

---

## ๐ ุงููุฑุงุฌุน

- [Hidden Markov Model (HMM) - Ultralytics](https://www.ultralytics.com/ar/glossary/hidden-markov-model-hmm)
- ุฎูุงุฑุฒููุฉ Viterbi ููุจุญุซ ุนู ุงููุณุงุฑ ุงูุฃูุซู
- Dynamic Programming ูู ูุนุงูุฌุฉ ุงููุบุงุช ุงูุทุจูุนูุฉ

---

**ุขุฎุฑ ุชุญุฏูุซ**: 2026-01-14  
**ุงูุญุงูุฉ**: ุงูุจููุฉ ุงูุฃุณุงุณูุฉ ููุชููุฉ โ  
**ุงูุชูุฏู**: 70% ูู ุงูุฎุทุฉ ุงููุงููุฉ
